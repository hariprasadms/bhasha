<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bhasha — English to Indian Languages</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Noto+Sans+Kannada:wght@400;600&family=Noto+Sans+Telugu:wght@400;600&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --saffron: #FF6B35;
      --ink: #0D0D1A;
      --cream: #FFF8EF;
      --gold: #F5C518;
      --teal: #00B4A0;
      --card-bg: #13092A;
      --border: rgba(255,255,255,0.08);
    }
    body {
      background: var(--ink);
      color: var(--cream);
      font-family: 'DM Sans', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    body::before {
      content: '';
      position: fixed;
      top: -200px; left: -200px;
      width: 600px; height: 600px;
      background: radial-gradient(circle, rgba(255,107,53,0.15) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }
    body::after {
      content: '';
      position: fixed;
      bottom: -200px; right: -200px;
      width: 600px; height: 600px;
      background: radial-gradient(circle, rgba(0,180,160,0.12) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem 1.5rem 4rem;
      position: relative;
      z-index: 1;
    }
    header { text-align: center; padding: 3rem 0 2.5rem; }
    .logo-row { display: flex; align-items: center; justify-content: center; gap: 0.75rem; margin-bottom: 0.5rem; }
    .logo-dot { width: 10px; height: 10px; background: var(--saffron); border-radius: 50%; animation: pulse 2s infinite; }
    @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(1.4)} }
    h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(2.5rem, 6vw, 4rem);
      font-weight: 900;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, var(--cream) 0%, var(--gold) 60%, var(--saffron) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .tagline { color: rgba(255,248,239,0.5); font-size: 0.95rem; font-weight: 300; letter-spacing: 0.08em; text-transform: uppercase; margin-top: 0.5rem; }
    .lang-badge-row { display: flex; gap: 0.6rem; justify-content: center; margin-top: 1.2rem; }
    .lang-badge { background: rgba(255,107,53,0.12); border: 1px solid rgba(255,107,53,0.3); color: var(--saffron); padding: 0.3rem 0.9rem; border-radius: 999px; font-size: 0.8rem; font-weight: 500; }
    .lang-selector { display: flex; gap: 1rem; margin-bottom: 1.5rem; }
    .lang-btn {
      flex: 1; padding: 1rem;
      background: var(--card-bg);
      border: 2px solid var(--border);
      border-radius: 14px;
      color: rgba(255,248,239,0.5);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.95rem; font-weight: 500;
      cursor: pointer;
      transition: all 0.25s ease;
      display: flex; flex-direction: column; align-items: center; gap: 0.3rem;
    }
    .lang-btn .native-name { font-size: 1.1rem; font-weight: 600; color: rgba(255,248,239,0.3); transition: color 0.25s; }
    .lang-btn:hover { border-color: rgba(255,107,53,0.4); color: var(--cream); }
    .lang-btn.active { border-color: var(--saffron); background: rgba(255,107,53,0.1); color: var(--cream); }
    .lang-btn.active .native-name { color: var(--gold); }
    #btn-kn .native-name { font-family: 'Noto Sans Kannada', sans-serif; }
    #btn-te .native-name { font-family: 'Noto Sans Telugu', sans-serif; }
    .panel { display: grid; grid-template-columns: 1fr 1fr; gap: 1.2rem; margin-bottom: 1.5rem; }
    @media(max-width:600px){ .panel{grid-template-columns:1fr} .lang-selector{flex-direction:column} }
    .box { background: var(--card-bg); border: 1px solid var(--border); border-radius: 18px; padding: 1.25rem; display: flex; flex-direction: column; gap: 0.75rem; transition: border-color 0.3s; }
    .box:focus-within { border-color: rgba(255,107,53,0.4); }
    .box-label { font-size: 0.72rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: rgba(255,248,239,0.4); }
    textarea { background: transparent; border: none; outline: none; color: var(--cream); font-family: 'DM Sans', sans-serif; font-size: 1rem; font-weight: 300; line-height: 1.7; resize: none; flex: 1; min-height: 160px; }
    textarea::placeholder { color: rgba(255,248,239,0.2); }
    #output-text { min-height: 160px; line-height: 1.8; font-size: 1.05rem; color: var(--cream); white-space: pre-wrap; word-break: break-word; }
    #output-text.kannada { font-family: 'Noto Sans Kannada', sans-serif; }
    #output-text.telugu  { font-family: 'Noto Sans Telugu', sans-serif; }
    #output-text.placeholder-state { color: rgba(255,248,239,0.2); font-style: italic; font-family: 'DM Sans', sans-serif; font-size: 0.95rem; }
    .char-count { font-size: 0.75rem; color: rgba(255,248,239,0.25); text-align: right; }
    .actions { display: flex; gap: 0.75rem; align-items: center; }
    .btn-translate {
      flex: 1; padding: 1rem 2rem;
      background: linear-gradient(135deg, var(--saffron), #E8500A);
      border: none; border-radius: 12px;
      color: white; font-family: 'DM Sans', sans-serif; font-size: 1rem; font-weight: 500;
      cursor: pointer; transition: all 0.25s ease;
      display: flex; align-items: center; justify-content: center; gap: 0.5rem;
    }
    .btn-translate:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(255,107,53,0.4); }
    .btn-translate:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-icon { width: 42px; height: 42px; background: rgba(255,255,255,0.06); border: 1px solid var(--border); border-radius: 8px; color: rgba(255,248,239,0.6); font-size: 1.1rem; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
    .btn-icon:hover { background: rgba(255,255,255,0.12); color: var(--cream); }
    .status-bar { min-height: 28px; text-align: center; font-size: 0.82rem; color: rgba(255,248,239,0.4); padding: 0.4rem; margin-top: 0.25rem; }
    .status-bar.loading { color: var(--gold); }
    .status-bar.error   { color: #FF4D6A; }
    .status-bar.success { color: var(--teal); }
    .spinner { display: inline-block; width: 13px; height: 13px; border: 2px solid rgba(245,197,24,0.3); border-top-color: var(--gold); border-radius: 50%; animation: spin 0.8s linear infinite; vertical-align: middle; margin-right: 6px; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .examples { margin-top: 2rem; }
    .examples-title { font-size: 0.72rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: rgba(255,248,239,0.3); margin-bottom: 0.75rem; }
    .example-chips { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .chip { background: rgba(255,255,255,0.04); border: 1px solid var(--border); border-radius: 999px; padding: 0.35rem 0.9rem; font-size: 0.82rem; color: rgba(255,248,239,0.55); cursor: pointer; transition: all 0.2s; user-select: none; }
    .chip:hover { background: rgba(255,107,53,0.1); border-color: rgba(255,107,53,0.4); color: var(--cream); }
    .toast { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(80px); background: var(--teal); color: white; padding: 0.65rem 1.4rem; border-radius: 999px; font-size: 0.85rem; font-weight: 500; transition: transform 0.3s ease; z-index: 100; pointer-events: none; }
    .toast.show { transform: translateX(-50%) translateY(0); }
    footer { text-align: center; padding: 2rem 0 0; color: rgba(255,248,239,0.2); font-size: 0.75rem; }
  </style>
</head>
<body>
<div class="container">
  <header>
    <div class="logo-row">
      <div class="logo-dot"></div>
      <h1>Bhasha</h1>
      <div class="logo-dot"></div>
    </div>
    <p class="tagline">English &rarr; Indian Language Translator</p>
    <div class="lang-badge-row">
      <span class="lang-badge">&#3221;&#3240;&#3277;&#3240;&#3233; Kannada</span>
      <span class="lang-badge">&#3108;&#3142;&#3122;&#3137;&#3095;&#3137; Telugu</span>
    </div>
  </header>

  <div class="lang-selector">
    <button class="lang-btn active" id="btn-kn">
      <span>Kannada</span>
      <span class="native-name">&#3221;&#3240;&#3277;&#3240;&#3233;</span>
    </button>
    <button class="lang-btn" id="btn-te">
      <span>Telugu</span>
      <span class="native-name">&#3108;&#3142;&#3122;&#3137;&#3095;&#3137;</span>
    </button>
  </div>

  <div class="panel">
    <div class="box">
      <span class="box-label">English</span>
      <textarea id="input-text" placeholder="Type or paste English text here..." maxlength="500"></textarea>
      <span class="char-count" id="char-count">0 / 500</span>
    </div>
    <div class="box">
      <span class="box-label" id="output-label">Kannada</span>
      <div id="output-text" class="placeholder-state">Translation will appear here...</div>
    </div>
  </div>

  <div class="actions">
    <button class="btn-translate" id="translate-btn" disabled>&#10022; Translate</button>
    <button class="btn-icon" id="clear-btn" title="Clear">&#10005;</button>
    <button class="btn-icon" id="copy-btn" title="Copy">&#9003;</button>
  </div>

  <div class="status-bar" id="status"></div>

  <div class="examples">
    <p class="examples-title">Try an example</p>
    <div class="example-chips" id="chips-container">
      <span class="chip">Hello, how are you?</span>
      <span class="chip">What is your name?</span>
      <span class="chip">I love India</span>
      <span class="chip">Good morning</span>
      <span class="chip">Thank you very much</span>
      <span class="chip">Where is the railway station?</span>
      <span class="chip">Please speak slowly</span>
    </div>
  </div>
</div>

<div class="toast" id="toast">Copied to clipboard!</div>
<footer><p>Powered by MyMemory &amp; Google Translate APIs &nbsp;&middot;&nbsp; MVP v1.0</p></footer>

<script>
(function () {
  'use strict';

  var LANGS = {
    kn: { label: 'Kannada', code: 'kn', cls: 'kannada' },
    te: { label: 'Telugu',  code: 'te', cls: 'telugu'  }
  };
  var activeLang = 'kn';
  var isRunning  = false;

  var inputEl      = document.getElementById('input-text');
  var outputEl     = document.getElementById('output-text');
  var outputLabel  = document.getElementById('output-label');
  var charCountEl  = document.getElementById('char-count');
  var statusEl     = document.getElementById('status');
  var translateBtn = document.getElementById('translate-btn');
  var clearBtn     = document.getElementById('clear-btn');
  var copyBtn      = document.getElementById('copy-btn');
  var toastEl      = document.getElementById('toast');

  /* ── Language switch ── */
  document.getElementById('btn-kn').addEventListener('click', function () { setLang('kn'); });
  document.getElementById('btn-te').addEventListener('click', function () { setLang('te'); });

  function setLang(lang) {
    activeLang = lang;
    document.getElementById('btn-kn').classList.toggle('active', lang === 'kn');
    document.getElementById('btn-te').classList.toggle('active', lang === 'te');
    outputLabel.textContent = LANGS[lang].label;
    showPlaceholder();
    setStatus('', '');
  }

  /* ── Input ── */
  inputEl.addEventListener('input', function () {
    charCountEl.textContent = inputEl.value.length + ' / 500';
    translateBtn.disabled = inputEl.value.trim() === '' || isRunning;
  });

  /* ── Example chips ── */
  document.getElementById('chips-container').addEventListener('click', function (e) {
    if (!e.target.classList.contains('chip')) return;
    inputEl.value = e.target.textContent.trim();
    charCountEl.textContent = inputEl.value.length + ' / 500';
    translateBtn.disabled = false;
    inputEl.focus();
  });

  /* ── Clear ── */
  clearBtn.addEventListener('click', function () {
    inputEl.value = '';
    charCountEl.textContent = '0 / 500';
    translateBtn.disabled = true;
    showPlaceholder();
    setStatus('', '');
  });

  /* ── Copy ── */
  copyBtn.addEventListener('click', function () {
    if (outputEl.classList.contains('placeholder-state')) return;
    var txt = outputEl.textContent || '';
    if (!txt) return;
    navigator.clipboard.writeText(txt).then(function () {
      toastEl.classList.add('show');
      setTimeout(function () { toastEl.classList.remove('show'); }, 2000);
    }).catch(function () {
      setStatus('Copy failed — select text manually.', 'error');
    });
  });

  /* ── Translate ── */
  translateBtn.addEventListener('click', runTranslation);
  document.addEventListener('keydown', function (e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter' && !translateBtn.disabled) runTranslation();
  });

  /* ── Core logic ── */
  function runTranslation() {
    var text = inputEl.value.trim();
    if (!text || isRunning) return;

    isRunning = true;
    translateBtn.disabled = true;
    translateBtn.innerHTML = '<span class="spinner"></span> Translating...';
    outputEl.className = '';
    outputEl.textContent = '';
    setStatus('<span class="spinner"></span> Translating...', 'loading');

    var langCode = LANGS[activeLang].code;

    // Try MyMemory first (most permissive CORS), then Google as fallback
    fetchMyMemory(text, langCode)
      .then(function (result) {
        onSuccess(result);
      })
      .catch(function (err1) {
        console.warn('MyMemory failed:', err1.message);
        setStatus('<span class="spinner"></span> Trying Google Translate...', 'loading');
        return fetchGoogle(text, langCode);
      })
      .then(function (result) {
        // This .then fires after EITHER the MyMemory success OR the Google fetch
        // We only reach here if MyMemory failed — result comes from Google
        if (!outputEl.textContent) { // only if not already set by onSuccess
          onSuccess(result);
        }
      })
      .catch(function (err2) {
        console.error('Google also failed:', err2.message);
        onError('Both translation services failed. Please check your internet connection.');
      });
  }

  function onSuccess(text) {
    if (!text || text.trim() === '') {
      onError('Received empty translation. Please try again.');
      return;
    }
    outputEl.className = LANGS[activeLang].cls;
    outputEl.textContent = text;
    setStatus('&#10003; Translation complete', 'success');
    resetBtn();
    isRunning = false;
  }

  function onError(msg) {
    showPlaceholder();
    setStatus('&#10005; ' + msg, 'error');
    resetBtn();
    isRunning = false;
  }

  function resetBtn() {
    translateBtn.disabled = inputEl.value.trim() === '';
    translateBtn.innerHTML = '&#10022; Translate';
  }

  /* ── MyMemory API ── */
  function fetchMyMemory(text, langCode) {
    var url = 'https://api.mymemory.translated.net/get?q='
      + encodeURIComponent(text) + '&langpair=en|' + langCode;

    return fetch(url, { method: 'GET' })
      .then(function (res) {
        if (!res.ok) throw new Error('HTTP ' + res.status);
        return res.json();
      })
      .then(function (json) {
        console.log('MyMemory response:', json);
        if (json.responseStatus !== 200) {
          throw new Error('Status ' + json.responseStatus + ': ' + (json.responseMessage || 'unknown'));
        }
        var t = json.responseData && json.responseData.translatedText;
        if (!t) throw new Error('Empty translatedText');
        // MyMemory sometimes echoes back the original on failure
        if (t.toLowerCase() === text.toLowerCase()) throw new Error('Translation unchanged');
        return t;
      });
  }

  /* ── Google Translate (unofficial) ── */
  function fetchGoogle(text, langCode) {
    var url = 'https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl='
      + langCode + '&dt=t&q=' + encodeURIComponent(text);

    return fetch(url)
      .then(function (res) {
        if (!res.ok) throw new Error('HTTP ' + res.status);
        return res.json();
      })
      .then(function (json) {
        console.log('Google response:', json);
        if (!json || !Array.isArray(json[0])) throw new Error('Unexpected response shape');
        var result = json[0]
          .filter(function (seg) { return seg && seg[0]; })
          .map(function (seg) { return seg[0]; })
          .join('');
        if (!result) throw new Error('Empty result');
        return result;
      });
  }

  /* ── Helpers ── */
  function showPlaceholder() {
    outputEl.className = 'placeholder-state';
    outputEl.textContent = 'Translation will appear here...';
  }

  function setStatus(html, type) {
    statusEl.innerHTML = html;
    statusEl.className = 'status-bar' + (type ? ' ' + type : '');
  }

})();
</script>
</body>
</html>
